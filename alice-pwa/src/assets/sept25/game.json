{
    "id": "lucca-sept25-v01",
    "credits": "credits.html",
    "rules": [
        {"trigger": "start", "effect": {"route": [""], "story": [{"read": "intro.html"}]}},

        {"trigger": "search:badge-brucaliffo", "effect": {"story": [{"read": "tappe/brucaliffo.html"}], "location": "map-brucaliffo"}},
        {"trigger": "visit:map-brucaliffo", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:2593", "rules": [
            {"condition": {"noTag": "brucaliffo"}, "effect": {"tag": "brucaliffo", "badge": "badge-brucaliffo", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-brucaliffo"], "story": [{"read": "tappe/brucaliffo-success.html"}]}}
        ]},

        {"trigger": "search:badge-dodo", "effect": {"story": [{"read": "tappe/dodo.html"}], "location": "map-dodo"}},
        {"trigger": "visit:map-dodo", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:6369", "rules": [
            {"condition": {"noTag": "dodo"}, "effect": {"tag": "dodo", "badge": "badge-dodo", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-dodo"], "story": [{"read": "tappe/dodo-success.html"}]}}
        ]},

        {"trigger": "search:badge-cappellaio-matto", "effect": {"story": [{"read": "tappe/cappellaio-matto.html"}], "location": "map-cappellaio-matto"}},
        {"trigger": "visit:map-cappellaio-matto", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:9184", "rules": [
            {"condition": {"noTag": "cappellaio-matto"}, "effect": {"tag": "cappellaio-matto", "badge": "badge-cappellaio-matto", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-cappellaio-matto"], "story": [{"read": "tappe/cappellaio-matto-success.html"}]}}
        ]},

        {"trigger": "search:badge-re-cuori", "effect": {"story": [{"read": "tappe/re-cuori.html"}], "location": "map-re-cuori"}},
        {"trigger": "visit:map-re-cuori", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:5834", "rules": [
            {"condition": {"noTag": "re-cuori"}, "effect": {"tag": "re-cuori", "badge": "badge-re-cuori", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-re-cuori"], "story": [{"read": "tappe/re-cuori-success.html"}]}}
        ]},

        {"trigger": "search:badge-regina-cuori", "effect": {"story": [{"read": "tappe/regina-cuori.html"}], "location": "map-regina-cuori"}},
        {"trigger": "visit:map-regina-cuori", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:7381", "rules": [
            {"condition": {"noTag": "regina-cuori"}, "effect": {"tag": "regina-cuori", "badge": "badge-regina-cuori", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-regina-cuori"], "story": [{"read": "tappe/regina-cuori-success.html"}]}}
        ]},

        {"trigger": "search:badge-pinco-panco", "effect": {"story": [{"read": "tappe/pinco-panco.html"}], "location": "map-pinco-panco"}},
        {"trigger": "visit:map-pinco-panco", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:8462", "rules": [
            {"condition": {"noTag": "pinco-panco"}, "effect": {"tag": "pinco-panco", "badge": "badge-pinco-panco", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-pinco-panco"], "story": [{"read": "tappe/pinco-panco-success.html"}]}}
        ]},

        {"trigger": "search:badge-fiori", "effect": {"story": [{"read": "tappe/fiori.html"}], "location": "map-fiori"}},
        {"trigger": "visit:map-fiori", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:9026", "rules": [
            {"condition": {"noTag": "fiori"}, "effect": {"tag": "fiori", "badge": "badge-fiori", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-fiori"], "story": [{"read": "tappe/fiori-success.html"}]}}
        ]},

        {"trigger": "search:badge-tricheco-carpentiere", "effect": {"story": [{"read": "tappe/tricheco-carpentiere.html"}], "location": "map-tricheco-carpentiere"}},
        {"trigger": "visit:map-tricheco-carpentiere", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:5499", "rules": [
            {"condition": {"noTag": "tricheco-carpentiere"}, "effect": {"tag": "tricheco-carpentiere", "badge": "badge-tricheco-carpentiere", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-tricheco-carpentiere"], "story": [{"read": "tappe/tricheco-carpentiere-success.html"}]}}
        ]},

        {"trigger": "search:badge-humpty-dumpty", "effect": {"story": [{"read": "tappe/humpty-dumpty.html"}], "location": "map-humpty-dumpty"}},
        {"trigger": "visit:map-humpty-dumpty", "effect": {"options": "ready-qrcode"}},
        {"trigger": "qrcode:1638", "rules": [
            {"condition": {"noTag": "humpty-dumpty"}, "effect": {"tag": "humpty-dumpty", "badge": "badge-humpty-dumpty", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-humpty-dumpty"], "story": [{"read": "tappe/humpty-dumpty-success.html"}]}}
        ]},

        {"trigger": "search:badge-stregatto", "effect": {"route": ["mappa"], "story": [{"read": "tappe/stregatto.html"}]}},
        {"trigger": "visit:map-lucca-libri", "effect": {"options": "lib-search", "story": [{"read": "tappe/libreria-lucca-libri.html"}]}},
        {"trigger": "visit:map-pensieri-belli", "effect": {"options": "lib-search", "story": [{"read": "tappe/libreria-pensieri-belli.html"}]}},
        {"trigger": "visit:map-il-collezionista", "effect": {"options": "lib-search", "story": [{"read": "tappe/libreria-il-collezionista.html"}]}},
        {"trigger": "qrcode:4482", "rules": [
            {"condition": {"noTag":"stregatto-testa"}, "effect": {"tag": "stregatto-testa", "badge": "badge-stregatto", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-stregatto"], "story": [{"read": "tappe/libreria-lucca-libri-testa.html"}]}}
        ]},
        {"trigger": "qrcode:3795", "rules": [
            {"condition": {"noTag":"stregatto-coda"}, "effect": {"tag": "stregatto-coda", "badge": "badge-stregatto", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-stregatto"], "story": [{"read": "tappe/libreria-pensieri-belli-coda.html"}]}}
        ]},
        {"trigger": "qrcode:8081", "rules": [
            {"condition": {"noTag":"stregatto-corpo"}, "effect": {"tag": "stregatto-corpo", "badge": "badge-stregatto", "score": 3}},
            {"effect": {"route": ["badgemap", "badges", "badge-stregatto"], "story": [{"read": "tappe/libreria-il-collezionista-corpo.html"}]}}
        ]},

        {"trigger": "toofar:franklin-33", "effect": {"story": [{"read": "tappe/franklin-33.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:franklin-33", "rules": [
            {"condition": {"noTag":"franklin-33"}, "effect": {"tag": "franklin-33", "score": 1}},
            {"effect": {"story": [{"read": "tappe/franklin-33.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:the-little-folk", "effect": {"story": [{"read": "tappe/the-little-folk.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:the-little-folk", "rules": [
            {"condition": {"noTag":"the-little-folk"}, "effect": {"tag": "the-little-folk", "score": 1}},
            {"effect": {"story": [{"read": "tappe/the-little-folk.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:ciclo-di-vino", "effect": {"story": [{"read": "tappe/ciclo-di-vino.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:ciclo-di-vino", "rules": [
            {"condition": {"noTag":"ciclo-di-vino"}, "effect": {"tag": "ciclo-di-vino", "score": 1}},
            {"effect": {"story": [{"read": "tappe/ciclo-di-vino.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:the-cervesia-taproom", "effect": {"story": [{"read": "tappe/the-cervesia-taproom.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:the-cervesia-taproom", "rules": [
            {"condition": {"noTag":"the-cervesia-taproom"}, "effect": {"tag": "the-cervesia-taproom", "score": 1}},
            {"effect": {"story": [{"read": "tappe/the-cervesia-taproom.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:the-cervesia-beershop", "effect": {"story": [{"read": "tappe/the-cervesia-beershop.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:the-cervesia-beershop", "rules": [
            {"condition": {"noTag":"the-cervesia-beershop"}, "effect": {"tag": "the-cervesia-beershop", "score": 1}},
            {"effect": {"story": [{"read": "tappe/the-cervesia-beershop.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:lebowski-cocktail-bar", "effect": {"story": [{"read": "tappe/lebowski-cocktail-bar.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:lebowski-cocktail-bar", "rules": [
            {"condition": {"noTag":"lebowski-cocktail-bar"}, "effect": {"tag": "lebowski-cocktail-bar", "score": 1}},
            {"effect": {"story": [{"read": "tappe/lebowski-cocktail-bar.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:alice-allo-specchio", "effect": {"story": [{"read": "tappe/alice-allo-specchio.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:alice-allo-specchio", "rules": [
            {"condition": {"noTag":"alice-allo-specchio"}, "effect": {"tag": "alice-allo-specchio", "score": 1}},
            {"effect": {"story": [{"read": "tappe/alice-allo-specchio.html"}], "options": "wanna-selfie"}}
        ]},
        {"trigger": "toofar:gelateria-de-coltelli", "effect": {"story": [{"read": "tappe/gelateria-de-coltelli.html"}, {"read": "tappe/toofar-locali.html"}]}},
        {"trigger": "visit:gelateria-de-coltelli", "rules": [
            {"condition": {"noTag":"gelateria-de-coltelli"}, "effect": {"tag": "gelateria-de-coltelli", "score": 1}},
            {"effect": {"story": [{"read": "tappe/gelateria-de-coltelli.html"}], "options": "wanna-selfie"}}
        ]},

        {"trigger": "toofar:map-san-martino", "effect": {"story": [{"read": "tappe/san-martino-toofar.html"}]}},
        {"trigger": "visit:map-san-martino", "rules": [
            {"condition": {"noTag":"san-martino"}, "effect": {"tag": "san-martino", "score": 2}},
            {"effect": {"route": ["badgemap", "badges"], "story": [{"read": "tappe/san-martino-success.html"}]}}
        ]},
        {"trigger": "toofar:map-piazza-anfiteatro", "effect": {"story": [{"read": "tappe/piazza-anfiteatro-toofar.html"}]}},
        {"trigger": "visit:map-piazza-anfiteatro", "rules": [
            {"condition": {"noTag":"piazza-anfiteatro"}, "effect": {"tag": "piazza-anfiteatro", "score": 2}},
            {"effect": {"route": ["badgemap", "badges"], "story": [{"read": "tappe/piazza-anfiteatro-success.html"}]}}
        ]},
        {"trigger": "toofar:map-torre-guinigi", "effect": {"story": [{"read": "tappe/torre-guinigi-toofar.html"}]}},
        {"trigger": "visit:map-torre-guinigi", "rules": [
            {"condition": {"noTag":"torre-guinigi"}, "effect": {"tag": "torre-guinigi", "score": 2}},
            {"effect": {"route": ["badgemap", "badges"], "story": [{"read": "tappe/torre-guinigi-success.html"}]}}
        ]},
        {"trigger": "toofar:map-piazza-napoleone", "effect": {"story": [{"read": "tappe/piazza-napoleone-toofar.html"}]}},
        {"trigger": "visit:map-piazza-napoleone", "rules": [
            {"condition": {"noTag":"piazza-napoleone"}, "effect": {"tag": "piazza-napoleone", "score": 1}},
            {"effect": {"route": ["badgemap", "badges"], "story": [{"read": "tappe/piazza-napoleone-success.html"}]}}
        ]},

        {"trigger": "visit:biblioteca-agora", "effect": {"options": "wanna-selfie", "story": [{"read": "tappe/biblioteca-agora.html"}]}},

        {"condition": {"badges": [
            "punteggio-gioco",
            "badge-brucaliffo",
            "badge-dodo",
            "badge-cappellaio-matto",
            "badge-re-cuori",
            "badge-regina-cuori",
            "badge-pinco-panco",
            "badge-fiori",
            "badge-tricheco-carpentiere",
            "badge-humpty-dumpty",
            "badge-stregatto"
        ], "noTag": "victory-shown"}, "effect": {"story": [{"read": "victory.html"}], "tag": "victory-shown"}
        }
    ],  
    "options": [
        {"id": "ready-qrcode", "read": "tappe/ready-qrcode.html", "options": [
            {"text": "Ho superato la prova! Devo registrare il codice QR con la fotocamera!", "effect": {"route": ["qrcode"]}},
            {"text": "Devo ancora superare la prova!", "effect": {"story": [{"read": "tappe/ready-to-play.html"}]}},
            {"text": "(esci)", "effect": {}}
        ]},
        {"id": "lib-search", "options": [
            {"text": "Fatto! Devo registrare il codice QR con la fotocamera!", "effect": {"route": ["qrcode"]}},
            {"text": "Devo ancora chiedere come fare...", "effect": {}}
        ]},
        {"id": "wanna-selfie", "read": "selfie/wanna-selfie.html", "options": [
            {"text": "Sì, apri la fotocamera!", "effect": {"route": ["camera"]}},
            {"text": "Non adesso, grazie...", "effect": {}}
        ]}
    ],
    "badges": [
        {"badge": "badge-brucaliffo", "src": "badges/brucaliffo.png"},
        {"badge": "badge-dodo", "src": "badges/dodo.png"},
        {"badge": "badge-cappellaio-matto", "src": "badges/cappellaio-matto.png"},
        {"badge": "badge-re-cuori", "src": "badges/re-cuori.png"},
        {"badge": "badge-regina-cuori", "src": "badges/regina-cuori.png"},
        {"badge": "badge-pinco-panco", "src": "badges/pinco-panco.png"},
        {"badge": "badge-fiori", "src": "badges/fiori.png"},
        {"badge": "badge-tricheco-carpentiere", "src": "badges/tricheco-carpentiere.png"},
        {"badge": "badge-humpty-dumpty", "src": "badges/humpty-dumpty.png"},
        {"badge": "badge-stregatto", "src": "badges/stregatto.png"}
    ],
    "svgmaps": [
        {"id": "welcome", "svg": "welcome.svg", "ids": []},
        {"id": "frame", "svg": "frame.svg", "ids": []},
        {"id": "badges", "svg": "badges.svg", "background": "g2776", "ids": [
            "badge-brucaliffo",
            "badge-dodo",
            "badge-cappellaio-matto",
            "badge-re-cuori",
            "badge-regina-cuori",
            "badge-pinco-panco",
            "badge-fiori",
            "badge-tricheco-carpentiere",
            "badge-humpty-dumpty",
            "badge-stregatto"
        ]}
    ],
    "locations": [
        {"id":"biblioteca-agora", "icon": "./assets/sept25/mappa/read-me.png", "anchor": [0.5, 1], "lon": 10.506014768376597, "lat": 43.84181452864434},
        {"id":"franklin-33", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.502028472868352, "lat": 43.84485690257682, "near": true},
        {"id":"the-little-folk", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.502387073489482, "lat": 43.84038685106595, "near": true},
        {"id":"ciclo-di-vino", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.508031250345251, "lat": 43.847012467131364, "near": true},
        {"id":"the-cervesia-taproom", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.508161060578765, "lat": 43.84695975439839, "near": true},
        {"id":"the-cervesia-beershop", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.504692893899197, "lat": 43.845106219219886, "near": true},
        {"id":"lebowski-cocktail-bar", "icon": "./assets/sept25/mappa/drink-me.png", "anchor": [0.5, 1], "lon": 10.503000461681347, "lat": 43.843436914687246, "near": true},
        {"id":"alice-allo-specchio", "icon": "./assets/sept25/mappa/wear-me.png", "anchor": [0.5, 1], "lon": 10.507589211793418, "lat": 43.84672705382186, "near": true},
        {"id":"gelateria-de-coltelli", "icon": "./assets/sept25/mappa/eat-me.png", "anchor": [0.5, 1], "lon": 10.501914082129673, "lat": 43.84293242006106, "near": true},
        {"id":"map-brucaliffo", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.506438300525973, "lat": 43.842945723669075},
        {"id":"map-dodo", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.504808035420542, "lat": 43.842967313755665},
        {"id":"map-cappellaio-matto", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.496645636980382, "lat": 43.840256949508664},
        {"id":"map-re-cuori", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.497064188776076, "lat": 43.84072889304245},
        {"id":"map-regina-cuori", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.50674329479071, "lat": 43.83947674502335},
        {"id":"map-pinco-panco", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.512347526987744, "lat": 43.84647871870673},
        {"id":"map-fiori", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.514214394688153, "lat": 43.84449340791067},
        {"id":"map-tricheco-carpentiere", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.506502858297749, "lat": 43.83945700482301},
        {"id":"map-humpty-dumpty", "icon": "./assets/sept25/mappa/spade.png", "anchor": [0.5, 1], "lon": 10.503999979922128, "lat": 43.841165129980084},
        {"id":"map-lucca-libri", "icon": "./assets/sept25/mappa/spade-lib.png", "anchor": [0.5, 1], "lon": 10.505437469176439, "lat": 43.83828244849533},
        {"id":"map-pensieri-belli", "icon": "./assets/sept25/mappa/spade-lib.png", "anchor": [0.5, 1], "lon": 10.501874162560684, "lat": 43.84049729895711},
        {"id":"map-il-collezionista", "icon": "./assets/sept25/mappa/spade-lib.png", "anchor": [0.5, 1], "lon": 10.503966069570199, "lat": 43.84222160447871},
        {"id":"map-san-martino", "icon": "./assets/sept25/mappa/find-me.png", "anchor": [0.5, 1], "lon": 10.505578328991632, "lat": 43.84096045281929, "near": true},
        {"id":"map-piazza-anfiteatro", "icon": "./assets/sept25/mappa/find-me.png", "anchor": [0.5, 1], "lon": 10.506146769057995, "lat": 43.845315996891706, "near": true},
        {"id":"map-torre-guinigi", "icon": "./assets/sept25/mappa/find-me.png", "anchor": [0.5, 1], "lon": 10.506892849357582, "lat": 43.84368847478595, "near": true},
        {"id":"map-piazza-napoleone", "icon": "./assets/sept25/mappa/find-me.png", "anchor": [0.5, 1], "lon": 10.502524026745453, "lat": 43.84132104910688, "near": true}
    ],
    "challenges": [],
    "audio": [
        {"id": "action", "src": "audio/action.ogg"}
    ],
    "buttons": [
        {"id": "badges", "icon": "./assets/sept25/biblio.svg", "action": ["badgemap", "badges"]},
        {"id": "mappa", "icon": "./assets/sept25/mappa.svg", "action": ["mappa"]},
        {"id": "credits", "icon": "./assets/sept25/credits.svg", "action": ["credits"]}
    ],
    "map": {
        "user": {"icon": "~/mappa/head.png", "anchor": [0.5, 1]},
        "lon": 10.506937856535545, 
        "lat": 43.84369534529272, 
        "zoom": 15
    }
}